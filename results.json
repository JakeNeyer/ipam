{
	"Golang errors": {
		"/Users/jake/ipam/terraform-provider-ipam/internal/provider/datasource_allocation.go": [
			{
				"line": 7,
				"column": 2,
				"error": "could not import github.com/JakeNeyer/ipam/terraform-provider-ipam/internal/client (invalid package name: \"\")"
			},
			{
				"line": 8,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/datasource (invalid package name: \"\")"
			},
			{
				"line": 9,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/datasource/schema (invalid package name: \"\")"
			},
			{
				"line": 10,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/types (invalid package name: \"\")"
			}
		],
		"/Users/jake/ipam/terraform-provider-ipam/internal/provider/provider.go": [
			{
				"line": 8,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/provider (invalid package name: \"\")"
			},
			{
				"line": 9,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/provider/schema (invalid package name: \"\")"
			},
			{
				"line": 10,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/resource (invalid package name: \"\")"
			}
		],
		"/Users/jake/ipam/terraform-provider-ipam/internal/provider/resource_allocation.go": [
			{
				"line": 8,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/path (invalid package name: \"\")"
			},
			{
				"line": 10,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/resource/schema (invalid package name: \"\")"
			},
			{
				"line": 11,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/resource/schema/int64planmodifier (invalid package name: \"\")"
			},
			{
				"line": 12,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/resource/schema/planmodifier (invalid package name: \"\")"
			},
			{
				"line": 13,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/resource/schema/stringplanmodifier (invalid package name: \"\")"
			},
			{
				"line": 15,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-log/tflog (invalid package name: \"\")"
			}
		],
		"/Users/jake/ipam/terraform-provider-ipam/main.go": [
			{
				"line": 8,
				"column": 2,
				"error": "could not import github.com/hashicorp/terraform-plugin-framework/providerserver (invalid package name: \"\")"
			},
			{
				"line": 9,
				"column": 2,
				"error": "could not import github.com/JakeNeyer/ipam/terraform-provider-ipam/internal/provider (invalid package name: \"\")"
			}
		]
	},
	"Issues": [
		{
			"severity": "HIGH",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "190",
				"url": "https://cwe.mitre.org/data/definitions/190.html"
			},
			"rule_id": "G115",
			"details": "integer overflow conversion uint32 -\u003e byte",
			"file": "/Users/jake/ipam/network/ipam.go",
			"code": "194: func u32ToIP(v uint32) net.IP {\n195: \treturn net.IPv4(byte(v\u003e\u003e24), byte(v\u003e\u003e16), byte(v\u003e\u003e8), byte(v))\n196: }\n",
			"line": "195",
			"column": "35",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "190",
				"url": "https://cwe.mitre.org/data/definitions/190.html"
			},
			"rule_id": "G115",
			"details": "integer overflow conversion uint32 -\u003e byte",
			"file": "/Users/jake/ipam/network/ipam.go",
			"code": "194: func u32ToIP(v uint32) net.IP {\n195: \treturn net.IPv4(byte(v\u003e\u003e24), byte(v\u003e\u003e16), byte(v\u003e\u003e8), byte(v))\n196: }\n",
			"line": "195",
			"column": "48",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "190",
				"url": "https://cwe.mitre.org/data/definitions/190.html"
			},
			"rule_id": "G115",
			"details": "integer overflow conversion uint32 -\u003e byte",
			"file": "/Users/jake/ipam/network/ipam.go",
			"code": "194: func u32ToIP(v uint32) net.IP {\n195: \treturn net.IPv4(byte(v\u003e\u003e24), byte(v\u003e\u003e16), byte(v\u003e\u003e8), byte(v))\n196: }\n",
			"line": "195",
			"column": "60",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "190",
				"url": "https://cwe.mitre.org/data/definitions/190.html"
			},
			"rule_id": "G115",
			"details": "integer overflow conversion int -\u003e uint",
			"file": "/Users/jake/ipam/server/handlers/block.go",
			"code": "24: \tones, bits := ipnet.Mask.Size()\n25: \treturn 1 \u003c\u003c uint(bits-ones)\n26: }\n",
			"line": "25",
			"column": "18",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "190",
				"url": "https://cwe.mitre.org/data/definitions/190.html"
			},
			"rule_id": "G115",
			"details": "integer overflow conversion int -\u003e uint",
			"file": "/Users/jake/ipam/network/ipam.go",
			"code": "234: \n235: \t\tincrement := uint(supernet_bits - prefixLength)\n236: \t\tfor i := len(current) - 1; i \u003e= 0; i-- {\n",
			"line": "235",
			"column": "20",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "HIGH",
			"cwe": null,
			"rule_id": "G704",
			"details": "SSRF via taint analysis",
			"file": "/Users/jake/ipam/terraform-provider-ipam/internal/client/client.go",
			"code": "56: \n57: \tresp, err := c.httpClient.Do(req)\n58: \tif err != nil {\n",
			"line": "57",
			"column": "30",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "HIGH",
			"cwe": null,
			"rule_id": "G704",
			"details": "SSRF via taint analysis",
			"file": "/Users/jake/ipam/server/oauth/github.go",
			"code": "79: \treq.Header.Set(\"Accept\", \"application/json\")\n80: \tresp, err := g.client.Do(req)\n81: \tif err != nil {\n",
			"line": "80",
			"column": "26",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "HIGH",
			"cwe": null,
			"rule_id": "G704",
			"details": "SSRF via taint analysis",
			"file": "/Users/jake/ipam/server/oauth/github.go",
			"code": "45: \treq.Header.Set(\"Accept\", \"application/json\")\n46: \tresp, err := g.client.Do(req)\n47: \tif err != nil {\n",
			"line": "46",
			"column": "26",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "HIGH",
			"cwe": null,
			"rule_id": "G703",
			"details": "Path traversal via taint analysis",
			"file": "/Users/jake/ipam/server/handlers/serve.go",
			"code": "81: func staticDirHasIndex(dir string) bool {\n82: \tf, err := os.Stat(filepath.Join(dir, \"index.html\"))\n83: \treturn err == nil \u0026\u0026 f != nil \u0026\u0026 !f.IsDir()\n",
			"line": "82",
			"column": "19",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "HIGH",
			"confidence": "HIGH",
			"cwe": null,
			"rule_id": "G703",
			"details": "Path traversal via taint analysis",
			"file": "/Users/jake/ipam/server/handlers/serve.go",
			"code": "36: \t\t}\n37: \t\tif f, err := os.Stat(p); err == nil \u0026\u0026 !f.IsDir() {\n38: \t\t\thttp.ServeFile(w, r, p)\n",
			"line": "37",
			"column": "23",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "676",
				"url": "https://cwe.mitre.org/data/definitions/676.html"
			},
			"rule_id": "G114",
			"details": "Use of net/http serve function that has no support for setting timeouts",
			"file": "/Users/jake/ipam/main.go",
			"code": "80: \tlogger.Info(\"server listening\", slog.String(\"addr\", \"http://\"+addr), slog.String(\"docs\", \"http://\"+addr+\"/docs\"))\n81: \tif err := http.ListenAndServe(addr, handler); err != nil {\n82: \t\tlogger.Error(\"server failed\", logger.ErrAttr(err))\n",
			"line": "81",
			"column": "12",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "LOW",
			"cwe": {
				"id": "79",
				"url": "https://cwe.mitre.org/data/definitions/79.html"
			},
			"rule_id": "G203",
			"details": "The used method does not auto-escape HTML. This can potentially lead to 'Cross-site Scripting' vulnerabilities, in case the attacker controls the input.",
			"file": "/Users/jake/ipam/server/swagger_theme.go",
			"code": "55: \t\u003c/style\u003e`\n56: \treturn template.HTML(css)\n57: }\n",
			"line": "56",
			"column": "9",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "89",
				"url": "https://cwe.mitre.org/data/definitions/89.html"
			},
			"rule_id": "G202",
			"details": "SQL string concatenation",
			"file": "/Users/jake/ipam/store/postgres.go",
			"code": "581: \tif limit \u003e 0 {\n582: \t\tselQ += fmt.Sprintf(` LIMIT $%d OFFSET $%d`, i, i+1)\n583: \t\tselArgs = append(selArgs, limit, offset)\n",
			"line": "582",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "89",
				"url": "https://cwe.mitre.org/data/definitions/89.html"
			},
			"rule_id": "G202",
			"details": "SQL string concatenation",
			"file": "/Users/jake/ipam/store/postgres.go",
			"code": "441: \tif limit \u003e 0 {\n442: \t\tselQ += fmt.Sprintf(` LIMIT $%d OFFSET $%d`, i, i+1)\n443: \t\tselArgs = append(selArgs, limit, offset)\n",
			"line": "442",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "89",
				"url": "https://cwe.mitre.org/data/definitions/89.html"
			},
			"rule_id": "G202",
			"details": "SQL string concatenation",
			"file": "/Users/jake/ipam/store/postgres.go",
			"code": "283: \tif limit \u003e 0 {\n284: \t\tselQ += fmt.Sprintf(` LIMIT $%d OFFSET $%d`, argIdx, argIdx+1)\n285: \t\tselArgs = append(selArgs, limit, offset)\n",
			"line": "284",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "499",
				"url": "https://cwe.mitre.org/data/definitions/499.html"
			},
			"rule_id": "G117",
			"details": "Exported struct field \"Password\" (JSON key \"password\") matches secret pattern",
			"file": "/Users/jake/ipam/server/handlers/signup.go",
			"code": "40: \tEmail    string `json:\"email\"`\n41: \tPassword string `json:\"password\"`\n42: }\n",
			"line": "41",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "499",
				"url": "https://cwe.mitre.org/data/definitions/499.html"
			},
			"rule_id": "G117",
			"details": "Exported struct field \"Password\" (JSON key \"password\") matches secret pattern",
			"file": "/Users/jake/ipam/server/handlers/setup.go",
			"code": "55: \tEmail    string `json:\"email\"`\n56: \tPassword string `json:\"password\"`\n57: }\n",
			"line": "56",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "499",
				"url": "https://cwe.mitre.org/data/definitions/499.html"
			},
			"rule_id": "G117",
			"details": "Exported struct field \"Password\" (JSON key \"password\") matches secret pattern",
			"file": "/Users/jake/ipam/server/handlers/auth.go",
			"code": "40: \tEmail    string `json:\"email\"`\n41: \tPassword string `json:\"password\"`\n42: }\n",
			"line": "41",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "499",
				"url": "https://cwe.mitre.org/data/definitions/499.html"
			},
			"rule_id": "G117",
			"details": "Exported struct field \"Password\" (JSON key \"password\") matches secret pattern",
			"file": "/Users/jake/ipam/server/handlers/admin.go",
			"code": "17: \tEmail          string    `json:\"email\"`\n18: \tPassword       string    `json:\"password\"`\n19: \tRole           string    `json:\"role\"`\n",
			"line": "18",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "MEDIUM",
			"cwe": {
				"id": "499",
				"url": "https://cwe.mitre.org/data/definitions/499.html"
			},
			"rule_id": "G117",
			"details": "Exported struct field \"ClientSecret\" (JSON key \"ClientSecret\") matches secret pattern",
			"file": "/Users/jake/ipam/server/config/config.go",
			"code": "23: \tClientID     string\n24: \tClientSecret string\n25: \tScopes       []string\n",
			"line": "24",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/Users/jake/ipam/server/handlers/serve.go",
			"code": "20: \t\tw.WriteHeader(http.StatusUnauthorized)\n21: \t\tw.Write([]byte(body))\n22: \t})\n",
			"line": "21",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/Users/jake/ipam/internal/setup/setup.go",
			"code": "30: \tif pg, ok := st.(*store.PostgresStore); ok {\n31: \t\tcloseFn = func() { pg.Close() }\n32: \t}\n",
			"line": "31",
			"column": "22",
			"nosec": false,
			"suppressions": null
		}
	],
	"Stats": {
		"files": 59,
		"lines": 9450,
		"nosec": 0,
		"found": 22
	},
	"GosecVersion": "dev"
}